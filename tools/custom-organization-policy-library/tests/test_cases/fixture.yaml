before_tests:
  - command: >- 
      gcloud compute networks create cuop-vpc-network
      --subnet-mode=custom
      --bgp-routing-mode=global
    teardown_command: >-
      gcloud compute networks delete cuop-vpc-network
  - command: gcloud kms keyrings create {{ prefix }}-key-ring-1 --location=asia-southeast2
    expected_result:
      return_code: 0
  - command: gcloud iam service-accounts create iam-sa-binding-allowed
    expected_result:
      return_code: 0
  - command: gcloud iam service-accounts create iam-sa-binding-unallowed
    expected_result:
      return_code: 0

after_tests:
  - command: gcloud iam service-accounts delete iam-sa-binding-allowed@{{ project }}.iam.gserviceaccount.com
    expected_result:
      return_code: 0
  - command: gcloud iam service-accounts delete iam-sa-binding-unallowed@{{ project }}.iam.gserviceaccount.com
    expected_result:
      return_code: 0
